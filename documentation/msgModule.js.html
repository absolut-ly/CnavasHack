<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: msgModule.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: msgModule.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * 
 * @param {*} urlString String url of the webhook to send post to. Required
 * @param {*} content String content of the post msg. Required
 * @param {*} username Display name of the discord bot that sent the msg to channel. Optional
 * @param {*} avatar_url url link to display img of discord bot. Optional
 */
const msgModule = (urlString, content, username, avatar_url) => {
  //npm install node-fetch
  const fetch = require('node-fetch');
  //npm install fs
  const fs = require('fs');
  let _whurl = "";
  const _msg = {};
  
  const sendMsg = () => {
    _whurl = urlString;
    _msg.content = content;
    if(username) _msg.username = username;
    if(avatar_url) _msg.avatar_url = avatar_url;
    
    //Creates a promise, POSTS msg and waits for the result from discord server. Appends the result to msg.log  
    fetch(_whurl + "?wait=true", {"method":"POST", "headers":{"content-type": "application/json"},"body": JSON.stringify(_msg)})
      .then(res => res.json())
      .then(json => {
        const stream = fs.createWriteStream('./msg.log', {flags: 'a'});
        for(let key in json) {
          stream.write(`${key}: ${JSON.stringify(json[key], null, 2)}\n`);
        }
        stream.write('\n\n');
        });
      
  }

  sendMsg();

};

exports.send = msgModule;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#msgModule">msgModule</a></li><li><a href="global.html#polling">polling</a></li><li><a href="global.html#scrape">scrape</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Mar 11 2021 22:03:35 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
